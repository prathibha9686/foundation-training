var sharedClipboard=function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var o=r(4);t.utils=o;var n=r(1);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return n.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return n.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return n.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return n.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return n.ConsoleLogger}});var i=r(5);t.browserSupport=i;var a=r(6);t.perfWatch=a;var s=r(7);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var l=r(8);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return l.initStopwatchFactory}});var d=r(9);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return d.TelemetryCollector}});var c=r(10);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return c.getNewGuid}});var u=r(11);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return u.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return u.TextAreaInputMode}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,o){return t.traceTag(0,e,r,o)},traceTag:function(e,r,o,n){return t.traceTag(e,r,o,n)},debugTrace:function(e,r,o){return t.debugTraceTag(0,e,r,o)},debugTraceTag:function(e,r,o,n){return t.debugTraceTag(e,r,o,n)},assert:function(e,r,o){return t.assertTag(0,e,r,o)},assertTag:function(e,r,o,n){return t.assertTag(e,r,o,n)},shipAssert:function(e,r,o){return t.shipAssertTag(0,e,r,o)},shipAssertTag:function(e,r,o,n){return t.shipAssertTag(e,r,o,n)},dnmTrace:function(e,r,o){return t.dnmTraceTag(0,e,r,o)},dnmTraceTag:function(e,r,o,n){return t.dnmTraceTag(e,r,o,n)}}}}};var o=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,o){console.assert(r,"shipAssertTag:",e,t,o)},e.prototype.assertTag=function(e,t,r,o){console.assert(r,"assertTag",e,t,o)},e.prototype.traceTag=function(e,t,r,o){console.log("traceTag",e,o,t,r)},e.prototype.dnmTraceTag=function(e,t,r,o){console.log("dnmTraceTag",e,o,t,r)},e.prototype.debugTraceTag=function(e,t,r,o){console.log("debugTraceTag",e,o,t,r)},e}();t.ConsoleLogger=o;var n=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=n},function(e,t,r){"use strict";var o={};r.r(o),r.d(o,"sharedClipboardSettingsVariableName",(function(){return D})),r.d(o,"defaultPromiseTimeoutInMinutes",(function(){return N})),r.d(o,"getSharedClipboardSettings",(function(){return J})),r.d(o,"initializeSharedClipboardSettingsFromWindow",(function(){return H})),r.d(o,"initializeSharedClipboardSettings",(function(){return j})),r.d(o,"createEmptySharedClipboardSettings",(function(){return V}));var n,i=r(0);function a(){return n}function s(e){if(!e)throw new Error("The 'logger' argument is missing");n=i.ULS.getFromExternalLogger(e)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.create;Object.create;var c,u,g,p,f;!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.FullAccessClipboardAndInMemory=3]="FullAccessClipboardAndInMemory",e[e.InMemory=4]="InMemory",e[e.LocalStorage=5]="LocalStorage",e[e.SystemClipboardAndLocalStorage=6]="SystemClipboardAndLocalStorage",e[e.SystemClipboardAndInMemory=7]="SystemClipboardAndInMemory"}(c||(c={})),function(e){e[e.UnsupportedClipboardStrategyType=0]="UnsupportedClipboardStrategyType",e[e.UnsupportedClipboardStorageType=1]="UnsupportedClipboardStorageType",e[e.ClipboardIsInaccessible=2]="ClipboardIsInaccessible",e[e.SetClipboardItems=3]="SetClipboardItems",e[e.GetClipboardItems=5]="GetClipboardItems",e[e.NoGetOperationResultMessage=7]="NoGetOperationResultMessage",e[e.NoSetOperationResultMessage=8]="NoSetOperationResultMessage",e[e.ClearClipboardItems=9]="ClearClipboardItems",e[e.MissingBrowserExtensionCapability=10]="MissingBrowserExtensionCapability",e[e.NoBrowserExtensionsInConfiguration=11]="NoBrowserExtensionsInConfiguration",e[e.NoAvailableBrowserExtensions=12]="NoAvailableBrowserExtensions",e[e.UnavailableBrowserExtension=13]="UnavailableBrowserExtension",e[e.NoBrowserExtensionWithGetClipboardDataCommand=14]="NoBrowserExtensionWithGetClipboardDataCommand",e[e.SelectClipboardStrategy=15]="SelectClipboardStrategy",e[e.IframeInitialization=16]="IframeInitialization",e[e.UnsupportedOperationCode=26]="UnsupportedOperationCode",e[e.RejectingPendingPastePromiseDueToNewPasteOperation=27]="RejectingPendingPastePromiseDueToNewPasteOperation",e[e.RejectingPendingCutCopyPromiseDueToNewCutCopyOperation=28]="RejectingPendingCutCopyPromiseDueToNewCutCopyOperation",e[e.RejectingBlockedSyncCutCopyPromise=29]="RejectingBlockedSyncCutCopyPromise",e[e.IframeInitializationTimeout=30]="IframeInitializationTimeout",e[e.ClipboardStrategyNotInitialized=33]="ClipboardStrategyNotInitialized",e[e.UnexpectedClipboardTextHtmlContentLength=34]="UnexpectedClipboardTextHtmlContentLength",e[e.InvalidClipboardStrategyType=35]="InvalidClipboardStrategyType",e[e.CreateWindowRPCServer=36]="CreateWindowRPCServer",e[e.RefreshMetadata=37]="RefreshMetadata",e[e.DeserializedMetadata=38]="DeserializedMetadata",e[e.SerializedMetadata=39]="SerializedMetadata",e[e.LocalStorageInitilizationInaccessible=40]="LocalStorageInitilizationInaccessible",e[e.LocalStorageInitilizationNoKey=41]="LocalStorageInitilizationNoKey",e[e.IframeProxyGeneralError=42]="IframeProxyGeneralError",e[e.IframeProxyEmptyResultMessage=43]="IframeProxyEmptyResultMessage"}(u||(u={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.CopyFlowHandlerNotFound=1]="CopyFlowHandlerNotFound",e[e.FetchCopyFlowHandlerFailed=2]="FetchCopyFlowHandlerFailed",e[e.FetchSourceItemFailed=3]="FetchSourceItemFailed",e[e.BeforeSerializeFailed=4]="BeforeSerializeFailed",e[e.SerializeFailed=5]="SerializeFailed",e[e.SerializeResultNotValid=6]="SerializeResultNotValid",e[e.AsyncSerializeFailed=7]="AsyncSerializeFailed",e[e.SaveToTheClipboardFailed=8]="SaveToTheClipboardFailed",e[e.InspectClipboardFailed=9]="InspectClipboardFailed",e[e.ClipboardIsInaccessible=10]="ClipboardIsInaccessible",e[e.SuccessiveCutCopyOverridingPendingCutCopy=11]="SuccessiveCutCopyOverridingPendingCutCopy",e[e.BlockedSynchronousCutCopy=12]="BlockedSynchronousCutCopy",e[e.CopyOperationCancelled=13]="CopyOperationCancelled",e[e.UnknownCopyErrorType=14]="UnknownCopyErrorType"}(g||(g={})),function(e){e[e.MissingArgumentError=0]="MissingArgumentError",e[e.PasteFlowHandlerNotFound=1]="PasteFlowHandlerNotFound",e[e.FetchPasteFlowHandlerFailed=2]="FetchPasteFlowHandlerFailed",e[e.FailedToReadFromClipboard=3]="FailedToReadFromClipboard",e[e.InspectClipboardFailed=4]="InspectClipboardFailed",e[e.ReadFromClipboardReturnNullOrUndefined=5]="ReadFromClipboardReturnNullOrUndefined",e[e.ClipboardIsEmpty=6]="ClipboardIsEmpty",e[e.DeserializeOperationFailed=7]="DeserializeOperationFailed",e[e.ClipboardIsInaccessible=8]="ClipboardIsInaccessible",e[e.SuccessivePasteOverridingPendingPaste=9]="SuccessivePasteOverridingPendingPaste",e[e.FileReaderResultIsEmpty=10]="FileReaderResultIsEmpty",e[e.FileReaderFailed=11]="FileReaderFailed",e[e.UnknownPasteError=12]="UnknownPasteError",e[e.DeferredPasteRejectedBecauseOtherCopyCompleted=13]="DeferredPasteRejectedBecauseOtherCopyCompleted",e[e.DeferredPasteRejectedBecauseOtherCopyStarted=14]="DeferredPasteRejectedBecauseOtherCopyStarted",e[e.DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext=15]="DeferredPasteRejectedBecauseMetadataUpdateWithoutCopyContext"}(p||(p={})),function(e){e[e.FailedToClearClipboard=0]="FailedToClearClipboard"}(f||(f={}));var h=function(e){function t(r,o,n){var s=this,l=t.augmentParameterValue(r);if((s=e.call(this,l)||this).name=t.augmentParameterValue(o),s.errorName=s.name,s.name?a().ULS.traceTag(596456211,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error '"+s.name+"': "+l):a().ULS.traceTag(596456212,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Error message: "+l),n){s.innerError=n;var d=s.innerError.message;d||(d=s.innerError.name);var c=t.augmentParameterValue(d);c.length>0&&a().ULS.traceTag(596456213,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Inner error message: "+c)}return s.stack||(s.stack=(new Error).stack),s}return d(t,e),t.augmentParameterValue=function(e){return e&&"string"==typeof e?e.trim():""},t}(Error),m=function(e){function t(t,r){return e.call(this,t,"NoValidKeyError",r)||this}return d(t,e),t}(h),S=function(e){function t(r,o,n){var i=this,a=h.augmentParameterValue(o),s=t.getDefaultMessage(a),l=h.augmentParameterValue(r);return 0===l.length&&(l=s),(i=e.call(this,l,"MissingArgumentError",n)||this).name=a,i}return d(t,e),t.getDefaultMessage=function(e){var t="Missing argument";return e.length>0&&(t="Missing argument: '"+e+"'"),t},t}(h),w=function(e){function t(r,o,n,i){var a=this,s=h.augmentParameterValue(o),l=n;l||(l="");var d=t.getDefaultMessage(s,l),c=h.augmentParameterValue(r);return 0===r.length&&(c=d),(a=e.call(this,c,"InvalidArgumentError",i)||this).name=s,a.value=l,a}return d(t,e),t.getDefaultMessage=function(e,t){return e.length>0?"Invalid '"+e+"' argument: '"+t+"'":"Invalid argument"},t}(h),C=function(e){function t(t,r){return e.call(this,t,"InvalidOperationError",r)||this}return d(t,e),t}(h);(function(e){function t(t,r){return e.call(this,t,"UnsupportedError",r)||this}d(t,e)})(h),function(e){function t(t,r,o,n,i){return e.call(this,t+". Data version: "+r+", Infra version: "+o+", blockMismatchDataVersion: "+n,"MismatchVersionError",i)||this}d(t,e)}(h),function(e){function t(t,r,o,n){return e.call(this,t+". Duration in clipboard (ms) : "+r+", TTL (ms): "+o,"TTLClipboardDataError",n)||this}d(t,e)}(h),function(e){function t(t,r,o,n){return e.call(this,t+". Data User Hash : "+r+", infra User Hash: "+o,"UserHashMismatchError",n)||this}d(t,e)}(h),function(e){function t(t,r){return e.call(this,t,"UnexpectedError",r)||this}d(t,e)}(h);function v(e,t){return function(e,t){return void 0!==e&&"number"==typeof e&&e>=0&&e<Object.keys(t).length/2}(e,t)?t[e]:""}var y=function(e){function t(t,r,o,n,i){var a=e.call(this,r||"reason="+t,o,n)||this;return a.reason=t,i&&(a.errorName=i),a}return d(t,e),t}(h),b=(function(e){function t(t,r,o){return e.call(this,t,r,"CopyError",o,v(t,g))||this}d(t,e)}(y),function(e){function t(t,r,o){return e.call(this,t,r,"PasteError",o,v(t,p))||this}d(t,e)}(y),function(e){function t(t,r,o){return e.call(this,t,r,"CancelError",o,v(t,f))||this}d(t,e)}(y),function(e){function t(t,r,o){return e.call(this,t,r,"ClipboardPlatformError",o,v(t,u))||this}return d(t,e),t}(y));!function(e){function t(t,r,o){return e.call(this,t,r,"SharedClipboardError",o,v(t,u))||this}d(t,e)}(y);new RegExp("(\\bTrident/| MSIE )"),new RegExp("\\bEdge/(\\d+\\.\\d+)\\b");var E={postMessage:function(e,t,r,o){e.postMessage(t,r,o)}};var T,L,I,P,_=(T={items:{}},{getData:function(){return T},getItem:function(e){},setItem:function(e,t){throw new C("Cannot set an item with clipboard data format '"+e+"' in an immutable empty clipboard (content is "+(t&&t.length>0?"not ":"")+"empty)")},hasDeferredItem:function(e){return!1},getDeferredItem:function(e){},get:function(){return U(void 0)}});function A(){return _}function M(e){return e&&e.items?Object.keys(e.items).length:0}function x(e){return M(e&&e.getData())}function W(e){void 0===e&&(e=void 0);var t=e;t||(t={items:{}});var r=function(e){return O(t,e)};return{getItem:r,setItem:function(e,r){!function(e,t,r){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");e.items[t]=r}(t,e,r)},hasDeferredItem:function(e){var t=r(e);return t&&t.length>0},getDeferredItem:function(e){return Promise.resolve(r(e))},getData:function(){return t},get:function(){return U(t)}}}function O(e,t){if(!e)throw new S("","clipboardItemsData");if(!e.items)throw new w("","clipboardItemsData.items");return e.items[t]}function U(e){var t=[];if(0===M(e))return t;for(var r in e.items){var o=O(e,r);o||(o="");var n={clipboardDataFormat:r,data:o,deferred:!1};t.push(n)}return t}!function(e){e[e.SystemClipboard=0]="SystemClipboard",e[e.InMemory=2]="InMemory",e[e.LocalStorage=3]="LocalStorage"}(L||(L={})),function(e){e[e.None=0]="None",e[e.Cut=1]="Cut",e[e.Copy=2]="Copy",e[e.Paste=4]="Paste",e[e.Values=16]="Values",e[e.Formatting=32]="Formatting",e[e.Formulas=64]="Formulas",e[e.DragDropCells=128]="DragDropCells",e[e.DragDropNoErrMsg=256]="DragDropNoErrMsg",e[e.Transpose=512]="Transpose",e[e.Link=1024]="Link",e[e.PasteValues=20]="PasteValues",e[e.PasteFormatting=36]="PasteFormatting",e[e.PasteFormulas=68]="PasteFormulas",e[e.PasteTranspose=516]="PasteTranspose",e[e.PasteLink=1028]="PasteLink"}(I||(I={})),function(e){e[e.NoError=0]="NoError",e[e.LocalStorageInaccessible=1]="LocalStorageInaccessible"}(P||(P={}));var D="sharedClipboardSettings",R=V(),F=!1,N=2;function J(){if(!F)throw new C("First initialize the settings via initializeSharedClipboardSettingsFromWindow() or initializeSharedClipboardSettings()");return R}function H(){F=!1,function(){if(!window||!(D in window))return R=V(),void(F=!0);var e=window[D];if(!e||"object"!=typeof e)return R=V(),void(F=!0);z(e)}()}function j(e){F=!1,z(e)}function z(e){if(!e)throw new S("","sharedClipboardSettingsCandidate");var t=V();if("number"!=typeof e.sharedClipboardSchemaVersion||isNaN(e.sharedClipboardSchemaVersion)||(t.sharedClipboardSchemaVersion=e.sharedClipboardSchemaVersion),"number"!=typeof e.sharedClipboardExpirationInMinutes||isNaN(e.sharedClipboardExpirationInMinutes)||(t.sharedClipboardExpirationInMinutes=e.sharedClipboardExpirationInMinutes),"number"!=typeof e.clipboardPromiseTimeoutInMinutes||isNaN(e.clipboardPromiseTimeoutInMinutes)||(t.clipboardPromiseTimeoutInMinutes=e.clipboardPromiseTimeoutInMinutes),"string"==typeof e.remoteLoggerPath&&e.remoteLoggerPath&&e.remoteLoggerPath.trim()&&(t.remoteLoggerPath=e.remoteLoggerPath),"number"!=typeof e.whitelistOriginComponents||1!==e.whitelistOriginComponents)return R=t,void(F=!0);if("string"!=typeof e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp||!e.sharedClipboardHostingApp.trim())return a().ULS.traceTag(596124181,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApp should be a non empty string"),R=t,void(F=!0);t.sharedClipboardHostingApp=e.sharedClipboardHostingApp.trim();var r=t.sharedClipboardHostingApp,o=r.indexOf("-");o>=0&&(r=r.substr(o+1));try{t.sharedClipboardHostingApps=e.sharedClipboardHostingApps?JSON.parse(e.sharedClipboardHostingApps):void 0}catch(t){a().ULS.traceTag(579737680,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps JSON parsing failed. String : "+e.sharedClipboardHostingApps)}if(!t.sharedClipboardHostingApps||!Array.isArray(t.sharedClipboardHostingApps)||0===t.sharedClipboardHostingApps.length||t.sharedClipboardHostingApps.some((function(e){return!e||!e.trim()})))return a().ULS.traceTag(596124182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingApps should be a JSON string representing an array with at list one app"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],R=t,void(F=!0);try{t.sharedClipboardHostingEnvironments=e.sharedClipboardHostingEnvironments?JSON.parse(e.sharedClipboardHostingEnvironments):void 0}catch(t){a().ULS.traceTag(579737681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments JSON parsing failed. String : "+e.sharedClipboardHostingEnvironments)}if(!t.sharedClipboardHostingEnvironments||!Array.isArray(t.sharedClipboardHostingEnvironments)||0===t.sharedClipboardHostingEnvironments.length||t.sharedClipboardHostingEnvironments.some((function(e){return!e||!e.trim()})))return a().ULS.traceTag(596124183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: sharedClipboardHostingEnvironments should be a JSON string representing an array with at list one environment"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(F=!0);if(t.sharedClipboardHostingApps.indexOf(t.sharedClipboardHostingApp)<0){if(t.sharedClipboardHostingApp===r)return a().ULS.traceTag(596124184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(F=!0);if(t.sharedClipboardHostingApps.indexOf(r)<0)return a().ULS.traceTag(596124185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"sharedClipboardSettings.initialize: when sharedClipboardHostingApp is defined, then its app name component '"+t.sharedClipboardHostingApp+"' or '"+r+"' should be listed in sharedClipboardHostingApps"),t.sharedClipboardHostingApp="",t.sharedClipboardHostingApps=[],t.sharedClipboardHostingEnvironments=[],R=t,void(F=!0)}t.whitelistOriginComponents=!0,R=t,F=!0}function V(){return{whitelistOriginComponents:!1,sharedClipboardHostingApp:"",sharedClipboardHostingApps:[],sharedClipboardHostingEnvironments:[],sharedClipboardSchemaVersion:1,sharedClipboardExpirationInMinutes:3600,clipboardPromiseTimeoutInMinutes:N,remoteLoggerPath:""}}var k,B,K=new RegExp("^\\d+$"),G=!1;function q(e){if(!e)throw new S("","origin");var t="",r=e.trim().toLowerCase().split("://",3);if(!r||0===r.length||!r[0]||"http"!==r[0]&&"https"!==r[0])throw new w("Missing protocol","origin",e);if(1===r.length)throw new w("Missing domain","origin",e);if(r.length>2)throw new w("'://' should appear once","origin",e);var o=r[1];if(!o)throw new w("Missing domain","origin",e);if(t=r[0]+"://",!(r=(o=o.trim()).trim().split("/",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2)throw new w("The last part of the origin should be the domain","origin",e);if(2===r.length&&r[1])throw new w("The last part of the origin should be the domain","origin",e);if(!(r=o.split(":",3))||0===r.length||!r[0]||!r[0].trim())throw new w("Missing domain","origin",e);if(r.length>2||2===r.length&&(!r[1]||!r[1].trim()))throw new w("The last part of the origin should be the domain and an optional port number","origin",e);if(t+=o=r[0].trim(),2===r.length){var n=r[1].trim(),s=K.exec(n);if(!s||1!==s.length)throw new w("Invalid port number","origin",e);var l=Number(n);if(isNaN(l))throw new w("Invalid port number","origin",e);t+=":"+n}return a().ULS.traceTag(596452423,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"getValidatedOrigin: origin = '"+e+"'; validated origin = '"+t+"'"),t}function Q(e){Z();var t,r=q(e),o=q((t="",window&&window.location&&window.location.origin?(t=window.location.origin)||(t=""):(a().ULS.traceTag(595932950,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"windowLocation.getWindowLocation: is window exist: "+!!window+". is window.location exist: "+(window&&!!window.location)+". is window.location.origin exist "+(window&&window.location&&!!window.location.origin)+". is window.location.protocol exist "+(window&&window.location&&!!window.location.protocol)+". is window.location.hostname exist "+(window&&window.location&&!!window.location.hostname)+". is window.location.port exist "+(window&&window.location&&!!window.location.port)),window&&window.location&&window.location.protocol&&window.location.hostname&&(t=window.location.protocol+"//"+window.location.hostname,window.location.origin=t)),{origin:t}).origin);if(r===o)return r;if(!J().whitelistOriginComponents)throw new C("validateOriginForReceivedMessage: Caller origin '"+e+"' doesn't match the current window's origin '"+o+"'");var n=X(r),s=X(o);if(n.protocol!==s.protocol)throw new C("validateRemoteWindowOrigin: Caller origin's protocol '"+n.protocol+"' doesn't match the current window origin's protocol '"+s.protocol+"'");if(n.environment!==s.environment)throw new C("validateRemoteWindowOrigin: Caller origin's environment '"+n.environment+"' doesn't match the current window origin's environment '"+s.environment+"'");return r}function X(e){Z();var t=e.split("://",2),r=t[0],o=$(t[1]),n={protocol:r};if(n.environment=Y(e,o,B),o.length<=n.environment.length+1)throw new w("Missing app component","origin",e);if("."!==o.charAt(n.environment.length))throw new w("Missing a domain separator after the environment component","origin",e);var i=o.substr(n.environment.length+".".length);if(n.app=Y(e,i,k),n.app.length<i.length&&"-"!==i.charAt(n.app.length))throw new w("When the Office Online app name is not the domain prefix, '-' should precede it","origin",e);return n}function $(e){if(!e)throw new S("","stringToReverse");for(var t="",r=e.length-1;r>=0;r-=1)t+=e.charAt(r);return t}function Y(e,t,r){if(!t)throw new S("","reversedValidatedHostname");if(!r)throw new S("","reversedStringsToLengthMap");var o=t.length,n=Object.keys(r).filter((function(e){var n=r[e];return n<=o&&t.substr(0,n)===e}));if(n&&n.length>0)return $(n[0]);throw new w("Invalid origin","validatedOrigin",e)}function Z(){if(!G){var e=J();e.whitelistOriginComponents&&(k=ee(e.sharedClipboardHostingApps),B=ee(e.sharedClipboardHostingEnvironments),G=!0)}}function ee(e){var t={};return e&&Array.isArray(e)&&0!==e.length?(e.forEach((function(e){t[$(e)]=e.length})),t):t}function te(){return oe()}function re(e){if(!e)throw new S("","id");var t=e.trim().toLowerCase();if(0===t.length)throw new w("","id");return t}function oe(){return(Math.random()+1).toString(36).substring(7)}var ne=function(){function e(){}return e.localStorageData="localStorage/data",e.localStorageMetadata="localStorage/metadata",e.initIframe="initIframe",e}();function ie(e){return"get"===e||"set"===e||"init"===e}var ae=function(e){if(!e)throw new S("","clipboardOperationMessage");if(!e.id||0===e.id.trim().length)throw new S("","id");if(!e.operationCode)throw new S("","operationCode");if(!e.destination)throw new S("","destination");if(!ie(e.operationCode))throw new w("","operationCode",e.operationCode);if("set"!==e.operationCode&&e.clipboardItemsData)throw new w("'"+e.operationCode+"' expects no clipboard items","clipboardItemsData")};function se(e,t,r,o,n){var i={id:e,operationCode:t,failed:r,error:o,clipboardItemsData:n};return le(i),i}var le=function(e){if(!e)throw new S("","clipboardOperationResultMessage");if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5494161_FixTag99sq1Spike")){for(var t=!1,r=0,o=["failed","error","clipboardItemsData","operationCode","id","userHash"];r<o.length;r++){var n=o[r];if(e.hasOwnProperty(n)){t=!0;break}}if(!t)throw new m("clipboardOperationResultMessage has no valid key")}if(!e.id||0===e.id.trim().length)throw Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5323309_LogsToInvestigate99sq1Spike")?a().ULS.traceTag(553747865,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Missing argument 'id'. keys: "+JSON.stringify(Object.keys(e))+", isConstructorObject: "+(e.constructor===Object)+", operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."):a().ULS.traceTag(560562970,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Missing argument 'id'. operationCode: "+e.operationCode+", id: "+e.id+", failed: "+e.failed+", error: "+e.error+"."),new S("","id");if(!e.operationCode)throw new S("","operationCode");if("getresult"!==e.operationCode&&"setresult"!==e.operationCode&&"initresult"!==e.operationCode&&"unknownresult"!==e.operationCode&&"getMetadata_longPollingresult"!==e.operationCode)throw new w("","operationCode",e.operationCode);if(e.failed){if(!e.error)throw new w("A failed '"+e.operationCode+"' operation expects a non-empty error argument","error");if(e.clipboardItemsData)throw new w("A failed '"+e.operationCode+"' operation does not expect a clipboardItemsData argument","clipboardItemsData")}else{if(e.error)throw new w("'"+e.operationCode+"' expects an empty error argument","error");if("unknownresult"===e.operationCode)throw new w("'"+e.operationCode+"' can only be used with a failure message","operationCode")}if("getresult"===e.operationCode||"getMetadata_longPollingresult"===e.operationCode){if(!e.failed&&!e.clipboardItemsData)throw new w("'"+e.operationCode+"' expects a clipboardItems argument","clipboardItemsData")}else if(e.clipboardItemsData)throw new w("'"+e.operationCode+"' expects no clipboardItemsData argument","clipboardItemsData")};function de(e){if(!e||0===e.trim().length)throw new w("","className",e);return function(){var t=!1;function r(t){return e+":"+t+": already disposed"}return{dispose:function(){t=!0},logIfDisposed:function(e){return t&&a().ULS.traceTag(596456217,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r(e)),t},throwIfDisposed:function(e){if(t)throw new C(r(e))}}}()}var ce=function(){function e(e,t,r){this.clipboardStrategyType=e,this.clipboardCapabilities=t,this.clipboardDataProcessor=r,this.disposableImplementationExtension=de(""+e)}return e.prototype.initialize=function(e){var t=this;return e.then((function(e){return t.clipboardStorage=e,a().ULS.traceTag(596453007,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Clipboard strategy type '"+t.clipboardStrategyType+"' was initialized."),Promise.resolve(t)}),(function(e){return a().ULS.traceTag(596453008,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Failed to initialize clipboard strategy type '"+t.clipboardStrategyType+"'. Error: "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},e.prototype.set=function(e,t){try{if(this.disposableImplementationExtension.throwIfDisposed("set"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121485,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.set: this.clipboardStorage should be defined"),Promise.reject(new b(u.ClipboardStrategyNotInitialized))}return this.clipboardDataProcessor&&this.clipboardDataProcessor.preSetProcess(e),this.clipboardStorage.set(e,t)}catch(e){return Promise.reject(new b(u.SetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").set",e))}},e.prototype.get=function(e){var t=this;try{if(this.disposableImplementationExtension.throwIfDisposed("get"),!this.clipboardStorage){return a().ULS.shipAssertTag(596121486,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.get: this.clipboardStorage should be defined"),Promise.reject(new b(u.ClipboardStrategyNotInitialized))}return this.clipboardStorage.get(e).then((function(e){return t.clipboardDataProcessor&&t.clipboardDataProcessor.postGetProcess(e),Promise.resolve(e)}))}catch(e){return Promise.reject(new b(u.GetClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").get",e))}},e.prototype.onSystemClipboardChangedExternally=function(e){try{return this.disposableImplementationExtension.throwIfDisposed("onSystemClipboardChangedExternally"),this.clipboardStorage?this.clipboardCapabilities.systemClipboard?Promise.resolve():this.clipboardStorage.set(A(),e):(a().ULS.shipAssertTag(595882508,i.LogCategory.msoulscat_ES_EWAJS,!1,"ClipboardStrategyBase.onSystemClipboardChangedExternally: this.clipboardStorage should be defined"),Promise.reject(new b(u.ClipboardStrategyNotInitialized)))}catch(e){return Promise.reject(new b(u.ClearClipboardItems,"Failed in (clipboard "+this.clipboardStrategyType+").onSystemClipboardChangedExternally",e))}},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(this.clipboardStorage&&this.clipboardStorage.dispose(),this.disposableImplementationExtension.dispose())},e}(),ue=!!window.performance&&!!window.performance.now&&!!window.performance.timing;function ge(e){var t=e;return t&&0!==t.trim().length||(t=te()),new me(t)}function pe(){return ue?window.performance.now():Date.now()}function fe(e){return ue?new Date(e+window.performance.timing.navigationStart):new Date(e)}function he(e,t,r){if(!r)throw new S("","creationTimestamp");return(e?"Fulfilled":"Still unfulfilled")+" after "+(e?t?t-r:"?":pe()-r)+"ms"}var me=function(){function e(t){var r=this;this.isFulfilled=!1,this.fulfillmentTimestamp=void 0,this.rejected=!1,this.id=re(t),e.sequenceId+=1,this.sequenceId=e.sequenceId,this.creationTimestamp=pe(),a().ULS.traceTag(596456225,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: creating deferred promise #"+this.sequenceId+" with id '"+this.id+"' on "+fe(this.creationTimestamp)),this.promise=new Promise((function(e,t){a().ULS.traceTag(596456226,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: registering callback for promise #"+r.sequenceId+" with id '"+r.id+"' on "+fe(pe())),r.internalResolve=e,r.internalReject=t}))}return e.prototype.fulfilled=function(){return this.isFulfilled},e.prototype.resolve=function(e){this.markAsFulfilled("resolve"),this.internalResolve?this.internalResolve(e):a().ULS.traceTag(596456257,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - resolve: the resolve for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.reject=function(e){this.markAsFulfilled("reject"),this.internalReject?this.internalReject(e):a().ULS.traceTag(596456260,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise - reject: the reject for deferred promise #"+this.sequenceId+" with id '"+this.id+"' is not tracked with a callback")},e.prototype.markAsFulfilled=function(e){this.fulfillmentCheck(e)||(this.isFulfilled=!0,this.rejected="resolve"!==e,this.fulfillmentTimestamp=pe(),a().ULS.traceTag(596456261,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: marking promise #"+this.sequenceId+" with id '"+this.id+"' as fulfilled ("+(this.rejected?"rejected":"resolved")+"). "+he(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)))},e.prototype.fulfillmentCheck=function(e){return a().ULS.traceTag(596456258,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise: asked to "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"'"),this.isFulfilled&&a().ULS.traceTag(596456259,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise: cannot "+e+" deferred promise #"+this.sequenceId+" with id '"+this.id+"' since it was "+(this.rejected?"rejected":"resolved")+" already on "+fe(this.fulfillmentTimestamp)+". "+he(this.isFulfilled,this.fulfillmentTimestamp,this.creationTimestamp)),this.isFulfilled},e.sequenceId=0,e}();!function(){function e(){this.deferredResultMessagePromiseCache={}}e.prototype.getDeferredPromise=function(e){var t=re(e);return this.deferredResultMessagePromiseCache[t]},e.prototype.getPromise=function(e){var t=this.getDeferredPromise(e);if(t)return a().ULS.traceTag(596456218,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: found a deferred promise with id '"+e+"'."),t.promise;a().ULS.traceTag(596456219,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: there is no deferred promise with id '"+e+"'.")},e.prototype.addNewPromise=function(e){var t=ge(e);if(this.getDeferredPromise(t.id))throw new w("A deferred promise already exists in the cache for the specified id","id",t.id);var r=re(t.id);return this.deferredResultMessagePromiseCache[r]=t,a().ULS.traceTag(596456220,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: added a new deferred promise with id '"+t.id+"'."),t},e.prototype.getLength=function(){var e=0;for(var t in this.deferredResultMessagePromiseCache)e+=1;return e},e.prototype.delete=function(e){if(this.getDeferredPromise(e)){var t=re(e);delete this.deferredResultMessagePromiseCache[t],a().ULS.traceTag(596456222,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: deleted id '"+e+"'.")}else a().ULS.traceTag(596456221,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: no need to delete an item with id '"+e+"' since this id is not associated with an existing deferred promise.")},e.prototype.clear=function(){if(a().ULS.traceTag(596456223,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Deferred promise cache: clearing "+this.getLength()+" items from the cache"),this.deferredResultMessagePromiseCache)for(var e in this.deferredResultMessagePromiseCache){var t=this.deferredResultMessagePromiseCache[e];if(t)try{t.reject()}catch(t){a().ULS.traceTag(596456224,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"Deferred promise cache: clear failed to reject promise id '"+e+"' with this exception: "+t.message+". Ignoring.")}}this.deferredResultMessagePromiseCache={}}}();function Se(e){if(!e)throw new S("","validator");return{deserialize:function(t){return function(e,t){if(!e)throw new S("","incomingMessage");if(!t)throw new S("","validator");if(0===e.length)throw new w("An empty message is invalid","incomingMessage");var r,o=e.trim();if(0===o.length)throw new w("A message cannot contain only spaces","incomingMessage");try{r=JSON.parse(o)}catch(t){throw new w("Deserialization failed","incomingMessage","Contains "+e.length.toString()+" characters",t)}if(!r)throw new w("Deserialization returned nothing","incomingMessage");return t(r),r}(t,e)}}}function we(e){if(!e)throw new S("","validator");return{serialize:function(t){return function(e,t){if(!e)throw new S("","outgoingMessage");if(!t)throw new S("","validator");return t(e),function(e){var t;try{t=JSON.stringify(e)}catch(t){throw new w("Serialization failed","outgoingMessage",Object.keys(e).length+" properties",t)}return a().ULS.traceTag(596452375,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The length of the serialized message is "+t.length),t}(e)}(t,e)}}}function Ce(e){if(!e)throw new S("","remoteWindow");if(!("window"in e)||!e.window)throw new S("","remoteWindow.window");if(!("windowOrigin"in e)||!e.windowOrigin)throw new S("","remoteWindow.windowOrigin");var t=Q(e.windowOrigin);return{window:e.window,windowOrigin:t}}var ve=function(){function e(e,t,r,o){this.serializer=e,this.deserializer=t,this.remoteWindow=r,this.remoteWindow=r,this._disposableImplementationExtension=de(o)}return Object.defineProperty(e.prototype,"disposableImplementationExtension",{get:function(){return this._disposableImplementationExtension},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){var e=this;this.disposableImplementationExtension.logIfDisposed("dispose")||(!function(e){if(e&&Array.isArray(e)&&0!==e.length){var t=0,r=void 0;if(e.forEach((function(e){if(t+=1,e)try{e()}catch(e){a().ULS.traceTag(596456216,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" threw an exception: "+e.message),r||(r=new C(e.message,e))}else a().ULS.traceTag(596456215,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: callback action #"+t+" is empty")})),r)throw r}else a().ULS.traceTag(596456214,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"rethrowAfterAllActions: no actions to execute")}([function(){e.sender&&e.sender.dispose()},function(){e.receiver&&e.receiver.dispose()}]),this.disposableImplementationExtension.dispose())},e.prototype.postMessage=function(e){if(this.disposableImplementationExtension.throwIfDisposed("postMessage"),!e)throw new S("","outgoingMessage");if(!this.sender){var t="WindowRPCBase::postMessage - this.sender should be defined";throw a().ULS.shipAssertTag(596121484,i.LogCategory.msoulscat_ES_EWAJS,!1,t),new C(t)}this.sender.postMessage(e)},e}();function ye(){return be}var be={addEventListener:function(e,t){return window.addEventListener(e,t)},removeEventListener:function(e,t){return window.removeEventListener(e,t)}};var Ee=function(){function e(e,t,r){var o=this;if(this.deserializer=e,this.handler=t,this.windowMessageHandler=function(e){return o.onMessageReceived(e)},!e)throw new S("","deserializer");if(!t)throw new S("","handler");if(!r)throw new S("","windowRPC");this.disposableImplementationExtension=de("WindowRPCReceiverInternal"),this.remoteWindow=Ce(r.remoteWindow),ye().addEventListener("message",this.windowMessageHandler)}return e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||(ye().removeEventListener("message",this.windowMessageHandler),this.disposableImplementationExtension.dispose())},e.prototype.shouldFilterMessageEvent=function(e){try{if(!e.origin||!e.source)return a().ULS.traceTag(596452370,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: ignoring messages from unspecified window sources."),!0;if(e.source===window)return a().ULS.traceTag(596452371,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from this window to itself."),!0;if(Object(i.ewaUtils)().isChangeGateEnabled("OfficeVSO:5405878_LogsToInvestigate99sq1Spike2")&&a().ULS.traceTag(544609310,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"this.remoteWindow.window is "+(this.remoteWindow.window?"defined":"not defined")+"."),this.remoteWindow.window&&e.source!==this.remoteWindow.window)return a().ULS.traceTag(596452372,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows other than the assigned remote window."),!0;if(e.origin.toLowerCase()!==this.remoteWindow.windowOrigin)return a().ULS.traceTag(596452373,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Verbose,"Window RPC Receiver: ignoring messages from windows with an origin that differs from remote window origin."),!0}catch(e){return!0}return!1},e.prototype.onMessageReceived=function(e){if(!this.shouldFilterMessageEvent(e)){var t=void 0;try{t=this.deserializer.deserialize(e.data)}catch(e){a().ULS.traceTag(596452374,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Window RPC Receiver: unable to deserialize incoming message. "+i.utils.getStringifiedError(e));try{this.handler.handleDeserializationError(e)}catch(e){a().ULS.traceTag(596452184,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to handle deserialization error. "+i.utils.getStringifiedError(e))}return}if(t)try{this.handler.handleMessage(t).catch((function(e){a().ULS.traceTag(595985880,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}))}catch(e){a().ULS.traceTag(596452186,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: unable to process incoming message. "+i.utils.getStringifiedError(e))}else a().ULS.traceTag(596452185,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"Window RPC Receiver: the incoming message is empty")}},e}();var Te=function(){function e(e,t,r){if(void 0===r&&(r=!1),this.serializer=e,this.delayedQueueEnabled=r,!e)throw new S("","serializer");if(!t)throw new S("","windowRPC");this.disposableImplementationExtension=de("WindowRPCSenderInternal"),this.remoteWindow=Ce(t.remoteWindow)}return e.prototype.postMessage=function(e){if(!e)throw new S("","outgoingMessage");if(!this.remoteWindow.window)throw new C("Configure the remote window");if(!this.remoteWindow.window.postMessage)throw new C("The remote window does not support postMessage");var t=this.serializer.serialize(e);E.postMessage(this.remoteWindow.window,t,this.remoteWindow.windowOrigin)},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function Le(e){return"OfficeOnlineCCP_Metadata_"+e}var Ie;!function(){function e(){this.startTime=i.perfWatch.timeStamp()}e.prototype.profilingMessage=function(e){var t=i.perfWatch.timeStamp()-this.startTime;return"onPasteProfiling: "+e+", pasteId: "+this.id+", timeMS: "+t.toFixed()}}();!function(e){e[e.Started=1]="Started",e[e.SynchronousPhaseCompleted=2]="SynchronousPhaseCompleted",e[e.Completed=3]="Completed"}(Ie||(Ie={}));var Pe=function(){function e(e){this.localStorageKey=e;try{if(!localStorage)throw new Error("LocalStorageClipboardStorage.ctor: localStorage == null")}catch(e){throw new b(u.LocalStorageInitilizationInaccessible,"LocalStorageClipboardStorage.ctor: filed access to localStorage",e)}if(!e)throw new b(u.LocalStorageInitilizationNoKey,"LocalStorageClipboardStorage.ctor: localStorageKey must be defined");this.clipboardStorageType=L.LocalStorage,this.disposableImplementationExtension=de("LocalStorageClipboardStorage")}return e.prototype.get=function(e){this.disposableImplementationExtension.throwIfDisposed("get"),a().ULS.traceTag(595716238,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.get: commandParameters.id='"+(e?e.id:"")+"'");var t=localStorage.getItem(this.localStorageKey);if(!t)return Promise.resolve(A());try{var r=JSON.parse(t);if(!r||0===M(r))return Promise.resolve(A());var o=W(r);return Promise.resolve(o)}catch(e){return Promise.resolve(A())}},e.prototype.set=function(e,t){this.disposableImplementationExtension.throwIfDisposed("set"),a().ULS.traceTag(595716239,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: item count="+x(e)+"'; commandParameters.id='"+(t?t.id:"")+"'"),0===x(e)?localStorage.removeItem(this.localStorageKey):localStorage.setItem(this.localStorageKey,JSON.stringify(e.getData()));var r=this.localStorageKey+"_LocalStorageChangedFlag",o=te();return a().ULS.traceTag(595654546,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"localStorageClipboardStorage.set: set local storage value. eventFalgKey = "+r+". eventFlagValue = "+o),localStorage.setItem(r,o),Promise.resolve()},e.prototype.getSupportedDataFormats=function(){return this.disposableImplementationExtension.throwIfDisposed("getSupportedDataFormats"),["text/plain","text/html","data/shadow-workbook"]},e.prototype.dispose=function(){this.disposableImplementationExtension.logIfDisposed("dispose")||this.disposableImplementationExtension.dispose()},e}();function _e(e){return a().ULS.traceTag(595716236,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard strategy type '"+c.LocalStorage+"' with localStorageKey: '"+e+"'"),(new Ae).initialize(function(e){try{a().ULS.traceTag(595716237,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"Attempting to create clipboard storage type '"+L.LocalStorage+"'");var t=new Pe(e);return Promise.resolve(t)}catch(e){return Promise.reject(e)}}(e))}var Ae=function(e){function t(t){return e.call(this,c.LocalStorage,{browserStorage:!0,systemClipboard:!1,inMemory:!1},t)||this}return d(t,e),t}(ce),Me=function(){function e(e,t,r){this.localStorageKeyToWatch=e,this.clipboardStrategy=t,this.listener=r,this.maxTimeToWaitInMilliseconds=2e3,this.lastLocalStorageValue=null,window.addEventListener("storage",this.onStorageChanged.bind(this)),this.raiseMetadataChangedEvent()}return e.prototype.onStorageChanged=function(e){var t=this;a().ULS.shipAssertTag(595716249,i.LogCategory.msoulscat_ES_EWAJS,null!=e,"e should not be null"),a().ULS.traceTag(595716288,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged:got storage change event. e.key = "+e.key+". localStorageKeyToWatch = "+this.localStorageKeyToWatch+". lastLocalStorageValue = "+this.lastLocalStorageValue),e.key===this.localStorageKeyToWatch&&(this.raiseMetadataChangedEvent(),a().ULS.traceTag(595716289,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.onStorageChanged: raised metadata change event. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged()||this.waitForLocalStorageValueToChange(this.maxTimeToWaitInMilliseconds).then((function(){t.raiseMetadataChangedEvent()}),(function(){a().ULS.traceTag(595716295,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.onStorageChanged: got rejected promise.")})))},e.prototype.raiseMetadataChangedEvent=function(){var e=this;return a().ULS.traceTag(595715525,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: starting raiseMetadataChangedEvent. lastLocalStorageValue = "+this.lastLocalStorageValue),this.clipboardStrategy.get({userHash:0}).then((function(t){e.listener(t),a().ULS.traceTag(595716232,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: sent message. lastLocalStorageValue = "+e.lastLocalStorageValue)}),(function(e){a().ULS.traceTag(595716233,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,"LocalStorageKeyChangeTracker.raiseMetadataChangedEvent: failed to get metadata from clipboardStorage")}))},e.prototype.isLocalStorageValueChanged=function(){var e=localStorage.getItem(this.localStorageKeyToWatch),t=this.lastLocalStorageValue!==e;return a().ULS.traceTag(595715526,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.isLocalStorageValueChanged: lastLocalStorageValue = "+this.lastLocalStorageValue+". currentLocalStorageValue = "+e),this.lastLocalStorageValue=e,t},e.prototype.waitForLocalStorageValueToChange=function(e){var t=this;if(a().ULS.traceTag(595715527,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: start waitForLocalStorageValueToChange. lastLocalStorageValue = "+this.lastLocalStorageValue),this.isLocalStorageValueChanged())return a().ULS.traceTag(595715528,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving because value was changed. lastLocalStorageValue = "+this.lastLocalStorageValue),Promise.resolve();var r=ge(),o=new Date,n=setInterval((function(){var s=(new Date).getTime()-o.getTime();a().ULS.traceTag(595715529,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: call by setInterval. startTime = "+o+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),t.isLocalStorageValueChanged()?(clearInterval(n),a().ULS.traceTag(595716234,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: resolving. startTime = "+o+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.resolve()):s>e&&(clearInterval(n),a().ULS.traceTag(595716235,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"LocalStorageKeyChangeTracker.waitForLocalStorageValueToChange: rejecting. startTime = "+o+". elapseTime = "+s+". lastLocalStorageValue = "+t.lastLocalStorageValue),r.reject())}),200);return r.promise},e}();new RegExp("(\n\r)|(\r\n)|(\r)","g"),new RegExp("(\t)","g"),new RegExp("<","g"),new RegExp(">","g");var xe,We=r(1);function Oe(e,t,r,o){var n=e.map((function(e){return function(e,t){var r={};r.G=e.tag,r.T=e.timestamp-t,r.M=e.message,r.C=e.category;var o=1e3*e.type+e.level;return r.D=o,r}(e,o)})),i=function(e,t,r,o){var n={};return n.T=e,n.L=t,n.S=r,n.I=o,n.V=1,n}(o,n,t,r);return JSON.stringify(i)}!function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(xe||(xe={}));var Ue;!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(Ue||(Ue={}));var De=function(){function e(t,r){var o=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){o.triggerUpload(!1,!1)},this.flush=function(){o.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(t,r){(window.clearTimeout(o.timeoutId),o.logCache.length>0)&&(o.uploadId+=1,function(e,t,r){if(""!==t){var o=window.navigator;if(o&&o.sendBeacon)o.sendBeacon(t,e);else{var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",t,r),n.send(e))}}}(Oe(o.logCache,o.userSessionId,o.uploadId,o.timestampBase),o.remoteUrlEndpoint,r),o.logCache=[],o.timestampBase=Date.now());t&&(o.timeoutId=window.setTimeout(o.triggerUploadAsync,e.uploadCadenceInMsSec))},this.userSessionId=t,this.remoteUrlEndpoint=r+"?usid="+t,window.setTimeout((function(){return o.triggerUpload(!0,!0)}),0)}return e.prototype.handleTrace=function(t){t.message.length>e.messageMaxChars&&(t.message=t.message.substr(0,e.messageMaxChars-e.trimmedMessage.length)+e.trimmedMessage),this.logCache.push(t),(this.logCache.length>e.uploadTriggerSize||t.level===Ue.Error)&&this.triggerUploadAsync()},e.messageMaxChars=3072,e.uploadCadenceInMsSec=3e4,e.uploadTriggerSize=30,e.trimmedMessage="... [Trimmed]",e}();var Re=Ue.Info;function Fe(e,t,r,o,n){if(!(o>Re)){var i={timestamp:Date.now(),category:r,tag:t,level:o,type:xe.Trace,message:n};e.handleTrace(i)}}function Ne(e,t){var r=function(e,t){var r=new De(e,t);return{sendTraceTag:function(e,t,o,n){return Fe(r,e,t,o,n)},shipAssertTag:function(e,t,o,n){o&&Fe(r,e,t,Ue.Error,n)},debugAssertTag:function(){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:r.flush,flushOnClose:r.flushOnClose}}(t,e);return{assertTag:function(e,t,o,n){return r.shipAssertTag(e,t,!o,n)},shipAssertTag:function(e,t,o,n){return r.shipAssertTag(e,t,!o,n)},debugTraceTag:r.sendTraceTag,traceTag:r.sendTraceTag}}var Je=function(e){function t(t){var r=e.call(this)||this;return r.clipboardStrategy=t,r.nameForTelemetry="ClipboardStrategyMessageHandler_StrategyType_"+t.clipboardStrategyType,r.addMessageHandler("get",{handleMessage:r.get.bind(r)}),r.addMessageHandler("set",{handleMessage:r.set.bind(r)}),r}return d(t,e),t.prototype.get=function(e,t){var r={userHash:e.userHash};return this.clipboardStrategy.get(r).then((function(e){return t.clipboardItemsData=e.getData(),Promise.resolve(t)}),(function(e){return He(t,e)}))},t.prototype.set=function(e,t){var r={userHash:e.userHash},o=void 0;return e.clipboardItemsData&&(o=e.clipboardItemsData),this.clipboardStrategy.set(W(o),r).then((function(){return Promise.resolve(t)}),(function(e){return He(t,e)}))},t}(function(){function e(){this._handlers={}}return e.prototype.handleMessage=function(e,t){return e&&e.operationCode in this._handlers?this._handlers[e.operationCode].handleMessage(e,t):He(t,new b(u.UnsupportedOperationCode,"Operation code '"+(e?e.operationCode:"incomingMessage is null")+"' is unsupported"))},e.prototype.addMessageHandler=function(e,t){e?e in this._handlers?a().ULS.shipAssertTag(595944464,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: handle for operation: "+e+" already exist"):this._handlers[e]=t:a().ULS.shipAssertTag(595944463,i.LogCategory.msoulscat_ES_EWAJS,!1,"BaseMessageHandler.addMessageHandler: expected operationCode to be defined")},e}());function He(e,t){return je(e,t),Promise.resolve(e)}function je(e,t){e.failed=!0,e.error=i.utils.getStringifiedError(t)}var ze=function(e){function t(t,r,o,n){var i=e.call(this,r,t,o,"WindowRPCServerInternal")||this;if(i.windowRPCServerState=n,!n)throw new b(u.CreateWindowRPCServer,"windowRPCServerState is undefined.");return i.receiver=function(e,t,r){return new Ee(e,t,r)}(t,i,i),i.sender=function(e,t){return new Te(e,t)}(r,i),i}return d(t,e),t.prototype.handleMessage=function(e){var t=this;if(a().ULS.traceTag(596452360,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"RPC Server - handleMessage: incomingMessage.id='"+(e&&e.id)+"'; incomingMessage.operationCode='"+(e&&e.operationCode)+"'; incomingMessage.clipboardItems.length="+M(e&&e.clipboardItemsData)),this.windowRPCServerState.isInitializationPending()&&e&&"init"===e.operationCode)return a().ULS.traceTag(596129562,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"The clipboard strategy is not initialized yet. Once it's done, it'll send an 'initresult' message."),Promise.resolve();var r=e&&e.id?e.id:"unknownmessageid",o=!e||!e.operationCode||!ie(e.operationCode),n={id:r,failed:o,error:void 0,operationCode:o?"unknownresult":e.operationCode+"result"};return this.routeOperation(e,n).then((function(e){return t.postMessage(e)})).catch((function(e){return a().ULS.traceTag(596452182,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send result message. Sending a failure message. "+i.utils.getStringifiedError(e)),n.clipboardItemsData=void 0,je(n,e),t.postMessage(n)})).catch((function(e){return a().ULS.traceTag(596452183,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleMessage: unable to send failure result message. "+i.utils.getStringifiedError(e)),Promise.reject(e)}))},t.prototype.routeOperation=function(e,t){if(this.windowRPCServerState.isInitializationPending())return He(t,new b(u.SelectClipboardStrategy,"A clipboard strategy had not been selected and initialized yet"));if(!this.windowRPCServerState.isInitializedSuccessfully())return He(t,this.windowRPCServerState.getClipboardInitError());if("init"===e.operationCode)return Promise.resolve(t);var r=this.windowRPCServerState.getMessageHandler(e.destination);return r?r.handleMessage(e,t):He(t,new b(u.SelectClipboardStrategy,"messageHandler does not exist"))},t.prototype.handleDeserializationError=function(e){return this.postMessage({id:"unknownmessageid",failed:!0,error:i.utils.getStringifiedError(e),operationCode:"unknownresult"}).catch((function(e){a().ULS.traceTag(596451867,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"RPC Server - handleDeserializationError: unable to send failure result message. "+i.utils.getStringifiedError(e))}))},t.prototype.postMessage=function(t){try{return e.prototype.postMessage.call(this,t),Promise.resolve()}catch(e){return Promise.reject(new C("Unable to post message for operation '"+(t&&t.operationCode?t.operationCode:"")+"'",e))}},t}(ve),Ve=function(e){function t(t,r,o){var n=e.call(this,o,"getMetadata_longPollingresult")||this;return n.localStorageKeyChangeTracker=new Me(r,t,n.raiseMetadataChangedEvent.bind(n)),n}return d(t,e),t.prototype.raiseMetadataChangedEvent=function(e){this.sendMessage(e.getData())},t}(function(){function e(e,t){this.windowRPCServer=e,this.operationCode=t}return e.prototype.sendMessage=function(e){if(this.windowRPCServer){var t=se(te(),this.operationCode,!1,void 0,e);this.windowRPCServer.postMessage(t)}},e}());function ke(e,t){if(!t)return Promise.resolve(!1);var r=function(e,t){try{var r=window.parent,o=e;if(!o)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");return new ze(Se(ae),we(le),{window:r,windowOrigin:o},t)}catch(e){return void a().ULS.shipAssertTag(595981475,i.LogCategory.msoulscat_ES_EWAJS,!1,"createWindowRPCServer failed with exception: "+i.utils.getStringifiedError(e))}}(e,Be);if(!r)return a().ULS.traceTag(595947554,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"initModuleState: Failed to create windowRPCServer"),Promise.resolve(!1);var o=ge("initmessageid");return(Ke={initMessageIdUniqueRunningSuffix:1,initializationDeferredPromise:o,windowRPCServer:r}).initializationDeferredPromise.promise.then((function(){return function(){var e=qe();if(a().ULS.shipAssertTag(595947555,i.LogCategory.msoulscat_ES_EWAJS,!!e,"sendClipboardInitializationSuccessResult: windowRPCServer must be defined"),!e)return Promise.reject(new C("sendClipboardInitializationSuccessResult cannot post a message since WindowRPCServer could not be created"));var t=se(Qe(),"initresult",!1);return e.postMessage(t)}()}),(function(e){return function(e){var t=qe();if(a().ULS.shipAssertTag(595947584,i.LogCategory.msoulscat_ES_EWAJS,!!t,"sendClipboardInitializationFailureResult: windowRPCServer must be defined"),!t)return Promise.reject(new C("sendClipboardInitializationFailureResult cannot post a message since WindowRPCServer could not be created"));var r=se(Qe(),"initresult",!0,i.utils.getStringifiedError(e));return t.postMessage(r)}(e)})).catch((function(){})),t.then((function(e){return Ke&&(Ke.metadataDataChangedMessageSender=new Ve(e.metadataClipboardStrategy,e.localStorageMetadataKeyToWatch,r)),function(e){var t=Object.keys(e).map((function(t){return"Name: "+t+", handlerName: "+(e[t]&&e[t].nameForTelemetry)})).join(", ");if(a().ULS.traceTag(595947585,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"markInitializationSuccess: Created and initialized ClipboardStrategies '"+t+"'"),a().ULS.shipAssertTag(595947586,i.LogCategory.msoulscat_ES_EWAJS,!!Ke,"markInitializationSuccess: windowRPCServerInternalState must be defined"),!Ke)return;Ke.clipboardOperationMessageHandlerMap=e,Ke.clipboardInitError=void 0,Ke.clipboardInitTimestamp=Date.now(),Ke.initializationDeferredPromise&&Ke.initializationDeferredPromise.resolve()}(e.messageHandlers),Promise.resolve(!0)}),(function(e){return function(e){if(a().ULS.traceTag(595947587,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Error,"markInitializationFailure: Failed to initialize ClipboardStrategies"),a().ULS.shipAssertTag(595947588,i.LogCategory.msoulscat_ES_EWAJS,!!Ke,"markInitializationFailure: windowRPCServerInternalState must be defined"),!Ke)return;Ke.clipboardOperationMessageHandlerMap=void 0,Ke.clipboardInitError=e,Ke.clipboardInitTimestamp=Date.now(),Ke.initializationDeferredPromise&&Ke.initializationDeferredPromise.reject(Ke.clipboardInitError)}(e),Promise.resolve(!1)}))}var Be={getMessageHandler:function(e){if(!Ke)return;if(!e)return void a().ULS.shipAssertTag(595945235,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: expected destination to be defined");if(!Ke.clipboardOperationMessageHandlerMap)return void a().ULS.shipAssertTag(595945236,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: clipboardOperationMessageHandlerMap is not initialized");if(!(e in Ke.clipboardOperationMessageHandlerMap))return void a().ULS.shipAssertTag(595945237,i.LogCategory.msoulscat_ES_EWAJS,!1,"getMessageHandler: "+e+" is not part of ClipboardStrategyMap");return Ke.clipboardOperationMessageHandlerMap[e]},isInitializationPending:Ge,isInitializedSuccessfully:function(){if(Ke)return!Ge()&&!!Ke.clipboardOperationMessageHandlerMap;return!1},getClipboardInitError:function(){if(Ke)return Ke.clipboardInitError;return}},Ke=void 0;function Ge(){return!Ke||!Ke.initializationDeferredPromise||!Ke.initializationDeferredPromise.fulfilled()}function qe(){if(Ke)return Ke.windowRPCServer}function Qe(){if(!Ke)return"";var e=Ke.initMessageIdUniqueRunningSuffix;return Ke.initMessageIdUniqueRunningSuffix+=1,"initmessageid"+e}function Xe(e){return-1===decodeURIComponent(window.location.href).indexOf(e)}function $e(){s(new We.ConsoleLogger),Object(i.initEwaUtils)({isChangeGateEnabled:Xe}),o.initializeSharedClipboardSettingsFromWindow();var e=i.utils.getQueryParameterByName(window.location.href,"CreatorOrigin")||"";if(!e)throw new S("remoteWindowOrigin is undefined","remoteWindowOrigin");e=Q(e);try{var t=i.utils.getQueryParameterByName(window.location.href,"usid")||"",r=o.getSharedClipboardSettings().remoteLoggerPath;if(r&&t)s(Ne(""+e+r,t))}catch(e){}var n=o.getSharedClipboardSettings().sharedClipboardSchemaVersion;return ke(e,_e(function(e){return"OfficeOnlineCCP_Data_"+e}(n)).then((function(e){var t=Le(n),r=function(e){return Le(e)+"_LocalStorageChangedFlag"}(n);return _e(t).then((function(t){var o={};return o[ne.localStorageData]=new Je(e),o[ne.localStorageMetadata]=new Je(t),{messageHandlers:o,localStorageMetadataKeyToWatch:r,dataClipboardStrategy:e,metadataClipboardStrategy:t}}))})))}r.d(t,"a",(function(){return $e}))},function(e,t,r){"use strict";r.r(t);var o=r(0);for(var n in o)"default"!==n&&function(e){r.d(t,e,(function(){return o[e]}))}(n);var i=r(2);r.d(t,"initialize",(function(){return i.a}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,o){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(o,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var o={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])}));var n=Object.getPrototypeOf(t);n&&"object"==typeof n&&Object.keys(n).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(o[e]=t[e])}));var i={};return Object.keys(o).forEach((function(t){i[t]=e(o[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var o=new RegExp("\\W+","g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(o,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got "+t));for(var r=Promise.reject(),o=function(t){r=r.catch((function(r){return e(t,r)}))},n=1;n<=t;n+=1)o(n);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),o=function(o){var n=e[o];r=r.catch((function(){return t(n)}))},n=1;n<e.length;n+=1)o(n);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,o=e.length,n=0;n<o&&(t=4294967295&((t<<5)+t^e.charCodeAt(n)),n!==o-1);n+=2)r=4294967295&((r<<5)+r^e.charCodeAt(n+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var o=-1,n=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(o=i.offset,n=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(o=i.startOffset,n=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;n=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var a=document.body.createTextRange();a.moveToElementText(n),a.setEndPoint("EndToStart",i),o=a.text.length}catch(e){return o}if(r)for(var s=!1;null!=n;)null===n.previousSibling&&null!==n.parentNode&&null!==n.parentNode.parentNode&&n.parentNode.parentNode.childNodes.length>1&&!s?(n=n.parentNode,s=!0):null!=(n=n.previousSibling)&&null!=n.textContent&&(o+=n.textContent.length,s&&(o+=1));else for(;null!=n;)null!=(n=n.previousSibling)&&null!=n.textContent&&(o+=n.textContent.length);return o},t.getBoundingRectForText=function(e,t,r,o){function n(e,t,r){if(!e||!e.textContent)return t;if(o&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,a=0;a<i.length&&t>=0;a+=1)t=n(i[a],t,r),o&&"DIV"===i[a].nodeName&&(t-=1);return t}void 0===o&&(o=!1);var i=document.createRange();return n(e,t,(function(e,t){return i.setStart(e,t)})),n(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var o={};t.promises=function(){return void 0===o.promises&&(o.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),o.promises}},function(e,t,r){"use strict";function o(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function n(e,t,r){e[t]=o()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=o(),r=e,i=t,a={},s=function(e,t,o){return function(e,t,r,o,i,a){n(e,"end",r);var s={sessionName:t,result:o?"success":"failure",message:a,marks:e},l=JSON.stringify(s);i(l)}(a,r,i,e,t,o)};return a.start=0,{mark:function(e){return function(e){return n(a,e,i)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var o={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return o},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");o=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var o=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(o=function(){return self.performance.now()}),function(r){var n=o(),i=r;return{reset:function(e){null!=e&&(i=e),n=o()},stop:function(r){var a=o()-n,s=JSON.stringify({Target:i,Duration:a.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var o=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,o=r.crypto||r.msCrypto;if(o){t.crypto=!0;try{return o.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: "+JSON.stringify(e))}}var n=!1,i=r.performance;try{i&&i.now&&i.now()!==1/0&&(n=!0)}catch(e){t.exceptions.push("perfNow: "+JSON.stringify(e))}for(var a=0;a<e.length;a+=1){try{if(n){t.perfNow=!0;var s=Math.floor(100*i.now())%10;(s<0||s>9)&&(s=0);for(var l=0;l<s;l+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: "+JSON.stringify(e))}e[a]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var o=15&e[r];return r+=1,("x"===t?o:3&o|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))}]);
//# sourceMappingURL=sharedClipboard.min.js.map